<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="mgQBoard">

	<!-- 질문게시판 카운트 -->
	<select id="countArticle" resultType="int">
		<![CDATA[
			select count(num) from QUESTIONBOARD where id=#{id} and num>0
		]]>
	</select>

	<!-- 질문게시판 테이블매칭 -->
	<resultMap id="read"   type="QBoard" >
		<result property="content" column="contents" />
	</resultMap>
	
	<!-- 질문게시판 전체목록 조회 및 검색조회 -->
	<select id="listAll" resultType="QBoard" resultMap="read">
		<include refid="pagingHeader"></include>	
			select * from QUESTIONBOARD 
		<include refid="search"></include>	 
		order by num DESC, regdate desc
		<include refid="pagingFooter"></include>
	</select>

	<!-- 검색조건 sql -->
	  <sql id="search">
	 	<choose>
	 		<!-- 검색옵션이 전체 검색일 경우 --> 
	 		<when test="searchOption='all'">
	 			where id = #{id} and (writer like '%'||#{keyword}||'%' or title like '%'||#{keyword}||'%')
	 		</when>
	 		<otherwise>
	 			where ${searchOption} like '%'||#{keyword}||'%'
	 		</otherwise>
	 	</choose>
	 </sql>
	 <sql id="pagingHeader">
	 	select * from ( select num as rn,A.* from(
	 </sql>
	 <sql id="pagingFooter">
	 		)A
	 	)where rn  between #{start} and #{end}
	 </sql>
	
	<!-- 질문게시판 -->
<!-- 	<select id="QList" resultType="QBoard" resultMap="read">
		SELECT * FROM QUESTIONBOARD
	</select> -->
	
	<!-- 질문게시판 상세보기 -->
	<select id="QRead" resultType="QBoard" resultMap="read">
		SELECT * FROM QUESTIONBOARD WHERE NUM=#{num} and id=#{id}
	</select>
	
	<!-- 질문게시판 검색 -->
<!-- 	<select id="QSerach" resultType="QBoard">
		select * from  QUESTIONBOARD where title = #{title}
	</select> -->








</mapper> 

