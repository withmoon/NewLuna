<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="mgSalesReserveDAO">

		<!-- 월 매출 게시판 카운트 -->
	<select id="countArticle" resultType="int">
		<!-- <![CDATA[
			select count(num) from ??? where num>0
		]]> --> 
	</select>
	
	
	<!-- 하루별 전체목록 조회 및 검색조회 --> 
	<select id="SalesReserveList" resultType="Statistics"> 
	<![CDATA[
		select reservdate ,count(*)as gunsu,sum(payamount)as total,count(DECODE(status,'-2',1)) as status,
		count(DECODE(status,'-1',1)) as status2 from roompayment  where reservdate>='19/01/01' and 
		reservdate<='19/03/28' group by reservdate order by reservdate asc
	]]>
	</select>
	<!-- <include refid="pagingHeader"></include>	
			select * from ???
		<include refid="search"></include>	 
		order by num DESC, regdate desc
		<include refid="pagingFooter"></include> -->

	<!-- 검색조건 sql -->
	  <sql id="search">
	 	<choose>
	 		<!-- 검색옵션이 전체 검색일 경우 -->
	 		<when test="searchOption='all'">
	 			where (writer like '%'||#{keyword}||'%' or title like '%'||#{keyword}||'%')
	 		</when>
	 		<otherwise>
	 			where ${searchOption} like '%'||#{keyword}||'%'
	 		</otherwise>
	 	</choose>
	 </sql>
	 <sql id="pagingHeader">
	 	select * from ( select num as rn,A.* from(
	 </sql>
	 <sql id="pagingFooter">
	 		)A
	 	)where rn  between #{start} and #{end}
	 </sql>



	<!-- 월별 -->
	<select id="SalesReservemonth" resultType="Statistics">
	<![CDATA[
		SELECT reservdate, count(*)as gunsu,sum(payamount)as total,
		count(DECODE(status,'-2',1)) as status,count(DECODE(status,'-1',1)) as status2 
		FROM roompayment GROUP BY reservdate order by reservdate desc
	]]>
	</select>
	


</mapper> 

